pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = .values, y = .resid)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = value, y = .resid)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = value, y = .resid)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = value, y = .resid)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = value, y = .resid)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = value, y = .resid)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = obs_index, y = value)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
View(train3)
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = train3, y = value)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot() +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = train3$G3, y = value)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = train3$romanticno, y = value)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
# 21976*38
21976*38
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = 3, y = value)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = c(1,2,3), y = value)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = len(train3), y = value)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
a <- vector( "numeric" , 65928)
a
a <- range(1, 65928)
a <- seq(1, 65928)
p_caseinf <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
ggplot(aes(x = a, y = value)) +
facet_wrap(~ name, scales = 'free_y', nrow = 3) + # looks better with vertical faceting
geom_point() +
geom_hline(aes(yintercept = 0)) + # add line at zero
theme(axis.text.x = element_text(angle = 90, vjust = 0.25)) + # rotates and aligns labels
labs(x = '', y = '')
p_caseinf
# largest two of each case influence stat
augment(fit, sat) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 1) %>%
select(.rownames, name, value)
# largest two of each case influence stat
augment(fit, sat) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 1) %>%
select(.rownames, name, value)
# largest two of each case influence stat
augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 1) %>%
select(.rownames, name, value)
# largest two of each case influence stat
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
select(.cooksd)
View(p_caseinf)
# largest two of each case influence stat
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
select(.cooksd)
# largest two of each case influence stat
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
select(.cooksd)
# largest two of each case influence stat
augment(new_model2, train3) %>%
select(.cooksd) %>%
slice_max(order_by = .cooksd, n = 2) %>%
select(.cooksd)
# largest two of each case influence stat
augment(new_model2, train3) %>%
select(.cooksd) %>%
top_n(2, wt = .cooksd)
# largest two of each case influence stat
augment(new_model2, train3) %>%
select(.cooksd) %>%
top_n(2, wt = .cooksd)
# largest two of each case influence stat
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
dplyr::select(.cooksd)
# largest two of each case influence stat
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
dplyr::select(.cooksd)
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 1) %>%
dplyr::select(.cooksd)
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
dplyr::select(.cooksd)
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 4) %>%
dplyr::select(.cooksd)
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 4)[1:2] %>%
dplyr::select(.cooksd)
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 4) %>%
dplyr::select(.cooksd)
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 4) %>%
dplyr::select(.cooksd)[1]
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 4) %>%
dplyr::select(.cooksd)
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
dplyr::select(.cooksd)
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 100) %>%
dplyr::select(.cooksd)
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
dplyr::select(.cooksd)
# most influential points
augment(new_model2, train3) %>%
slice_max(order_by = .hat, n = 4) %>%
dplyr::select(.hat)
# most influential points
high_influence <- augment(new_model2, train3) %>%
slice_max(order_by = .hat, n = 4) %>%
dplyr::select(.hat)
p_caseinf + geom_point(data = high_influence, color = 'red')
unusual_obs <- augment(fit, sat) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
View(unusual_obs)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red')
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=a, y=value))
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=a, y=value))
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
View(unusual_obs)
# most influential points
high_influence <- augment(new_model2, train3) %>%
slice_max(order_by = .hat, n = 4) %>%
dplyr::select(.hat)
View(high_influence)
# most influential points
high_influence <- augment(new_model2, train3) %>%
slice_max(order_by = .hat, n = 2) %>%
dplyr::select(.hat)
View(high_influence)
View(high_influence)
# most outlying points
high_residuals <- augment(new_model2, train3) %>%
slice_max(order_by = .hat, n = 2) %>%
dplyr::select(.resid)
View(high_residuals)
# most influential points
high_influence <- augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
mutate(row_index = .rownames)
# most influential points
high_influence <- augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
mutate(row_index = as.numeric(rownames(train3)))
# most influential points
high_influence <- augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 2) %>%
mutate(row_index = row_number())
View(high_influence)
# most outlying points
high_residuals <- augment(new_model2, train3) %>%
slice_max(order_by = .resid, n = 2) %>%
mutate(row_index = row_number())
View(high_residuals)
# most outlying points
high_residuals <- augment(new_model2, train3) %>%
slice_max(order_by = .resid, n = 2) %>%
mutate(row_index = row_number())
high_leverage <- augment(new_model2, train3) %>%
slice_max(order_by = .resid, n = 2) %>%
mutate(row_index = row_number())
View(high_leverage)
# highest leverage points
high_leverage <- augment(new_model2, train3) %>%
slice_max(order_by = .resid, n = 2) %>%
mutate(row_index = row_number())
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(romanticno) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 22)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(romanticno) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 22)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 286)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(G3) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
View(unusual_obs)
b <- seq(1, 442)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 10)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
View(unusual_obs)
# highest leverage points
high_leverage <- augment(new_model2, train3) %>%
slice_max(order_by = .leverage, n = 2) %>%
mutate(row_index = row_number())
# highest leverage points
high_leverage <- augment(new_model2, train3) %>%
slice_max(order_by = .hat, n = 2) %>%
mutate(row_index = row_number())
View(high_leverage)
# most influential points
high_influence <- augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 1) %>%
mutate(row_index = row_number())
# most outlying points
high_residuals <- augment(new_model2, train3) %>%
slice_max(order_by = .resid, n = 1) %>%
mutate(row_index = row_number())
# highest leverage point
high_leverage <- augment(new_model2, train3) %>%
slice_max(order_by = .hat, n = 1) %>%
mutate(row_index = row_number())
View(high_residuals)
# most outlying points
high_residuals <- augment(new_model2, train3) %>%
slice_max(order_by = .resid, n = 1) %>%
mutate(row_index = row_number())
# highest leverage point
high_leverage <- augment(new_model2, train3) %>%
slice_max(order_by = .hat, n = 1) %>%
mutate(row_index = row_number())
b <- seq(1, 10)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 1) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
# most influential point
high_influence <- augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 1) %>%
mutate(row_index = row_number())
View(high_leverage)
View(high_residuals)
high_leverage['.resid']
b <- seq(1, 10)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 5) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 36)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 5) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 36)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 5) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 36)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 10) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
b <- seq(1, 47)
unusual_obs <- augment(new_model2, train3) %>%
pivot_longer(cols = c(.resid, .hat, .cooksd)) %>%
group_by(name) %>%
slice_max(order_by = abs(value), n = 10) %>%
ungroup()
p_caseinf + geom_point(data = unusual_obs, color = 'red', aes(x=b, y=value))
# most influential point
high_influence <- augment(new_model2, train3) %>%
slice_max(order_by = .cooksd, n = 5) %>%
mutate(row_index = row_number())
View(high_influence)
# most outlying points
high_residuals <- augment(new_model2, train3) %>%
slice_max(order_by = .resid, n = 5) %>%
mutate(row_index = row_number())
# highest leverage point
high_leverage <- augment(new_model2, train3) %>%
slice_max(order_by = .hat, n = 5) %>%
mutate(row_index = row_number())
high_leverage['.resid']
data.frame(high_leverage['.resid'], high_residuals['.hat'])
data.frame(high_leverage['.resid'][1:12,], high_residuals['.hat'])
data.frame(high_leverage['.resid'][1:12,], high_residuals['.hat'])
high_leverage['.resid'][1:12,]
high_leverage['.resid']
